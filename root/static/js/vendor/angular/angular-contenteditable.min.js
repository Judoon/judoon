angular.module("contenteditable",[]).directive("contenteditable",["$timeout",function(k){return{restrict:"A",require:"?ngModel",link:function(l,d,m,e){if(e){var f={};angular.forEach(["stripBr","noLineBreaks","selectNonEditable","moveCaretToEndOnChange"],function(a){var b=m[a];f[a]=b&&"false"!==b});d.bind("input",function(a){l.$apply(function(){var b,a,g;b=d.html();g=!1;f.stripBr&&(b=b.replace(/<br>$/,""));f.noLineBreaks&&(a=b.replace(/<div>/g,"").replace(/<br>/g,"").replace(/<\/div>/g,""),a!==b&&
(g=!0,b=a));e.$setViewValue(b);g&&e.$render();""===b&&k(function(){d[0].blur();d[0].focus()})})});var h=e.$render;e.$render=function(){var a,b,c;h&&h();d.html(e.$viewValue||"");f.moveCaretToEndOnChange&&(a=d[0],b=document.createRange(),c=window.getSelection(),0<a.childNodes.length&&(a=a.childNodes[a.childNodes.length-1]),b.setStartAfter(a),b.collapse(!0),c.removeAllRanges(),c.addRange(b))};f.selectNonEditable&&d.bind("click",function(a){var b,c;c=a.toElement;c!==this&&"false"===angular.element(c).attr("contenteditable")&&
(a=document.createRange(),b=window.getSelection(),a.setStartBefore(c),a.setEndAfter(c),b.removeAllRanges(),b.addRange(a))})}}}}]);

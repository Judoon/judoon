<div ng-controller="PageCtrl">
  <div class="navbar">
    <div class="navbar-inner">
      <ul class="nav">
        <li ng-class="{active: !editmode}"><a ng-click="editmode = 0" id="preview_mode" href="#">Preview</a></li>
        <li ng-class="{active:  editmode}"><a ng-click="editmode = 1" id="edit_mode" href="#">Edit</a></li>
        <li><a ng-class="{'save-disabled': !pageDirty, 'save-ready': pageDirty}" ng-click="updatePage()" href="#">Save</a></li>

        <li class="divider-vertical"></li>
        <li><a href="#">New from existing</a></li>
        <li class="divider-vertical"></li>

        <li><a href="#">Update Source Data</a></li>

        <li class="divider-vertical"></li>

        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a tabindex="-1" href="#">As data</a>
              <ul class="dropdown-menu">
                <li><a href="#">Excel (.xls)</a></li>
                <li><a href="#">Excel (.xlsx)</a></li>
                <li><a href="#">CSV (.csv)</a></li>
                <li><a href="#">Tab-separated (.tab)</a></li>
              </ul>
            </li>

            <li class="dropdown-submenu">
              <a tabindex="-1" href="#">As app</a>
              <ul class="dropdown-menu">
                <li><a href="#">zip</a></li>
                <li><a href="#">tar.gz</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="">Share</a></li>
      </ul>
    </div>
  </div>

  <div ng-show="editmode" class="editable_label" style="margin-bottom: -10px;">Page Title:</div>
  <h2 judoon-ck ck-edit-type="inline" ng-class="{edit_outline: editmode}" ng-model="page.title" id="page_title" contenteditable="true" class="editable inline_editable" ng-bind-html="page.title"></h2>

  <div ng-show="editmode" class="editable_label">Preamble:</div>
  <div judoon-ck ck-edit-type="block" ng-class="{edit_outline: editmode}" id="page_preamble" ng-model="page.preamble" contenteditable="true" class="editable block_editable" ng-bind-html="page.preamble"></div>
  <br>

  <div ng-show="editmode" class="table_edit_ctrls well well-small" ng-controller="ColumnCtrl">
    <form ng-submit="addColumn()" style="display: inline-block; margin-bottom: 5px;">
      <h6>Add new column</h6>
      <div class="input-append">
        <input type="text" placeholder="Column name" required  ng-model="newColumnName">
        <button type="submit" class="btn">Add</button>
      </div>
    </form>
    <span style="margin-left: 2em; margin-right: 2em;">-or-</span>
    <form style="display: inline-block; margin-bottom: 5px;">
      <h6>Update existing column</h6>
      <div class="input-append">
        <select ng-model="currentColumn" ng-options="c.title for c in page.columns">
        </select>
      </div>
    </form>
    <span style="margin-left: 2em; margin-right: 2em;">-or-</span>
    <form style="display: inline-block; margin-bottom: 5px;">
      <h6 class="text-warning">Delete a column</h6>
      <div class="input-append">
        <select ng-model="deleteColumn" ng-options="c.title for c in page.columns">
        </select>
        <button type="submit" ng-click="removeColumn()" class="btn btn-danger">Delete</button>
      </div>
    </form>
    <hr>

    <form ng-show="currentColumn">
      <div class="control-group">
        <label class="control-label" for="page.title">Title: </label>
        <div class="controls">
          <input type="text" class="input-block-level" required name="page.title" id="page.title" ng-model="currentColumn.title">
        </div>
      </div>

      <div class="control-group">
        <label class="control-label" for="page.layout">Layout: </label>
        <div class="controls">
          <input type="text" class="input-block-level" name="page.layout" id="page.layout" ng-model="currentColumn.template">
        </div>
      </div>
    </form>
    <p ng-show="!currentColumn" class="text-center muted">No column selected.</p>
  </div>

  <table judoon-table="" id="data_table" class="table table-striped table-condensed table-bordered">
    <thead>
      <th ng-repeat="column in page.columns">{{ column.title }}</th>
    </thead>
    <tbody>
    </tbody>
  </table>

  <br>

  <div ng-show="editmode" class="editable_label">Postamble:</div>
  <div judoon-ck ck-edit-type="block" ng-class="{edit_outline: editmode}" ng-model="page.postamble" id="page_postamble" contenteditable="true" class="editable block_editable" ng-bind-html="page.postamble"></div>

</div>

<div>

  <ul class="breadcrumb">
    <li><a href="/user/{{userName}}" target="_self">Overview</a> <span class="divider">/</span></li>
    <li>Dataset: {{dataset.name}}</li>
  </ul>

  <style type="text/css">
    h4 { padding-bottom: 5px; border-bottom: 1px lightgray solid; }

    .outer-hscroll { width: 99%; }
    .inner-hscroll { overflow-x: scroll; }

    fieldset { min-width: auto; }

    #ds_columns td {
      vertical-align: top;
      text-align: center;
    }
    #ds_columns th, #ds_columns td { border-top: none; }
    #ds_columns th { white-space: nowrap; }

    .add-panel { border: 1px lightgray solid; border-radius: 3px; padding: 5px; margin-top: 5px; }
  </style>

  <alert ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)">{{alert.msg}}</alert>

  <!-- ******************** PROPERTIES ******************** -->
  <h4 ng-click="hideProperties = !hideProperties">
    <i ng-show="hideProperties" class="icon icon-chevron-right"></i>
    <i ng-show="!hideProperties" class="icon icon-chevron-down"></i>
    Properties
  </h4>
  <div collapse="hideProperties">
  <form class="form-horizontal" ng-submit="saveDataset()">
    <fieldset>

      <div class="control-group">
        <label class="control-label">Name</label>
        <div class="controls">
          <input type="text" ng-model="dataset.name" required class="span6" />
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Notes</label>
        <div class="controls">
          <textarea class="span6" ng-model="dataset.notes"></textarea>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Public</label>
        <div class="controls">
          <select class="span2" ng-model="dataset.permission" ng-options="permission.value as permission.label for permission in permissions">
          </select>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save changes</button>
        <button type="button" ng-click="resetDataset()" class="btn">Cancel</button>
      </div>

    </fieldset>
  </form>
  </div>


  <!-- ******************** DATA ******************** -->
  <h4 ng-click="hideData = !hideData">
    <i ng-show="hideData" class="icon icon-chevron-right"></i>
    <i ng-show="!hideData" class="icon icon-chevron-down"></i>
    Data
  </h4>
  <div collapse="hideData">
    <div class="outer-hscroll"><div class="inner-hscroll">

    <judoon-data-table
       jdt-dataset-id="datasetId"
       jdt-columns="dataset.columns"
       jdt-header-key="name"
       jdt-fetch-fn="getServerData">
    </judoon-data-table>

    </div></div>
  </div>


  <!-- ******************** COLUMNS ******************** -->
  <h4 ng-click="hideColumns = !hideColumns">
    <i ng-show="hideColumns" class="icon icon-chevron-right"></i>
    <i ng-show="!hideColumns" class="icon icon-chevron-down"></i>
    Columns
  </h4>
  <div collapse="hideColumns">
    <div class="outer-hscroll"><div class="inner-hscroll">
    <table id="ds_columns" class="table table-striped table-bordered">
      <tbody>
        <tr class="odd">
          <th class="header">Column</th>
          <td class="name" ng-repeat="column in dataset.columns">
            <span class="label">{{column.name}}</span>
          </td>
        </tr>

        <tr class="even">
          <th class="header">Sample Data</th>
          <td class="sample_data" ng-repeat="column in dataset.columns">
            {{column.samples.join(', ')}}&nbsp;
          </td>
        </tr>

        <tr class="odd">
          <th class="header">Accession Type</th>
          <td class="metadata" ng-repeat="column in dataset.columns">
            {{column.accession_type}}
          </td>
        </tr>

        <tr class="even">
          <th class="header">Column Type</th>
          <td class="metadata" ng-repeat="column in dataset.columns">
            {{column.data_type}}
          </td>
        </tr>

        <tr class="odd">
          <th class="header">Actions</th>
          <td class="annotate center" ng-repeat="column in dataset.columns">
            <button class="btn btn-mini">Annotate</button>
          </td>
        </tr>

      </tbody>
    </table>
    </div></div>

    <div style="padding: 1em;">
      <div ng-include src="'/static/html/partials/dscolumn.html'"></div>
    </div>
  </div>


  <!-- ******************** PAGES ******************** -->
  <h4 ng-click="hidePages = !hidePages">
    <i ng-show="hidePages" class="icon icon-chevron-right"></i>
    <i ng-show="!hidePages" class="icon icon-chevron-down"></i>
    Pages
  </h4>
  <div collapse="hidePages">
    <ul>
      <li ng-repeat="page in dataset.pages">
        <a href="/user/{{userName}}/page/{{page.id}}" target="_self">{{page.title}}</a>
      </li>
    </ul>

    <div class="row-fluid">
      <div class="add-panel span7">
        <form ng-submit="createPage()" class="form-horizontal">
          <fieldset>
        <h5 style="margin: 0 5px 0; padding-top: 5px;" class="help-inline">Create New Page:</h5>
        <label class="radio inline">
          <input type="radio" ng-model="newPage.type" value="blank">
          Blank Page
        </label>
        <label class="radio inline">
          <input type="radio" ng-model="newPage.type" value="clone">
          Clone existing page
        </label>
        <label class="radio inline">
          <input type="radio" ng-model="newPage.type" value="template">
          From Template
        </label>

        <div ng-switch on="newPage.type" style="padding-top: 5px; padding-bottom: 5px; margin-left: 3em; border-bottom: thin #ddd solid;">
          <div ng-switch-when="clone">
            <span class="help-inline">Use existing page's layout:</span>
            <select ng-model="newPage.clone_from" ng-options="allPage.id as allPage.title for allPage in allPages">
            </select>
            <span class="help-block">
              Create a new page that mimics the layout of an exsiting
              page.
            </span>
          </div>
          <div ng-switch-when="template">
            <span class="help-inline">Template file to create with:</span>
            <input type="file" id="clone_template">
            <span class="help-block">Create a new page from a provided template.</span>
          </div>
          <div ng-switch-default>
            <span class="help-block">Create a new page without columns.</span>
          </div>
        </div>
        <button type="submit" class="btn">Create</button>
        </fieldset>
        </form>
      </div>
    </div>
  </div>

</div>

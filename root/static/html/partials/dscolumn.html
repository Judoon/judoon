  <form  ng-controller="DatasetColumnCtrl">
    <fieldset>
      <legend>Add new computed column</legend>

      <div class="row-fluid">
        <div class="span12">
          <label class="control-label">New Column Name:
            <input type="text" ng-model="newColumnName" required>
          </label>
        </div>
      </div>

      <div class="row-fluid">

        <div class="span4">
          <div>
            <h5>Transform Type:</h5>
            <select name="type" ng-model="transformType" ng-options="type.name for type in transformTypes">
            </select>
          </div>

          <div ng-show="transformType">
            <h5>Transform:</h5>
            <select name="transform" ng-model="transform" ng-options="act.name for act in transformType.transforms">
            </select>
          </div>

          <div ng-show="transform">
            <h5>Source Column:</h5>
            <select name="source" ng-model="sourceColumn" ng-options="column.name for column in filteredColumns">
            </select>
          </div>

          <div ng-show="transform">
          <div ng-switch on="transform.id">

            <div ng-switch-when="join">
              <div>
                <h5>Join Dataset:</h5>
                <select name="jds" ng-model="$parent.joinDataset" ng-options="ds.name for ds in myDatasets"></select>
              </div>

              <div ng-show="$parent.joinDataset">
                <h5>Join Column:</h5>
                <select name="jcol" ng-model="$parent.joinColumn" ng-options="jcol.name for jcol in joinDataset.columns"></select>
              </div>

              <div ng-show="$parent.joinColumn">
                <h5>Output Column:</h5>
                <select name="ocol"  ng-model="$parent.outputColumn" ng-options="ocol.name for ocol in joinDataset.columns"></select>
              </div>
            </div>

            <div ng-switch-default>
              <div ng-show="sourceColumn && transform.inputs">
                <h5>Source Type:</h5>
                <select name="input" ng-model="$parent.inputType" ng-options="input for input in transform.inputs">
                </select>
              </div>

              <div ng-show="sourceColumn && transform.outputs">
                <h5>Produce:</h5>
                <select name="produce" ng-model="$parent.outputType" ng-options="output for output in transform.outputs">
                </select>
              </div>
            </div>
          </div>
        </div>
        </div>

        <div class="span4">
        </div>

        <div class="span4">
          <h5>Result:</h5>
          <ul ng-show="results">
            <li ng-repeat="result in results">{{result.value}}</li>
          </ul>
        </div>

      </div>

      <div class="form-actions">
        <button ng-click="submitNewColumn()" class="btn btn-primary">Add column</button>
      </div>
      
    </fieldset>
  </form>
